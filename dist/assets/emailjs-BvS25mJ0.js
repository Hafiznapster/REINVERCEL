var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r={}.hasOwnProperty,i={}.propertyIsEnumerable,o=(t,r,i)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[r]=i,a=(e,a)=>{for(var s in a||(a={}))r.call(a,s)&&o(e,s,a[s]);if(t)for(var s of t(a))i.call(a,s)&&o(e,s,a[s]);return e},s=(e,t,r)=>new Promise((i,o)=>{var a=e=>{try{n(r.next(e))}catch(t){o(t)}},s=e=>{try{n(r.throw(e))}catch(t){o(t)}},n=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,s);n((r=r.apply(e,t)).next())});class n{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const l={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:(()=>{if("undefined"!=typeof localStorage)return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}})()},c=e=>e?"string"==typeof e?{publicKey:e}:"[object Object]"===e.toString()?e:{}:{},d=(e,t,...r)=>s(void 0,[e,t,...r],function*(e,t,r={}){const i=yield fetch(l.origin+e,{method:"POST",headers:r,body:t}),o=yield i.text(),a=new n(i.status,o);if(i.ok)return a;throw a}),m=(e,t,r)=>{if(!e||"string"!=typeof e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||"string"!=typeof t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||"string"!=typeof r)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},p=e=>e.webdriver||!e.languages||0===e.languages.length,h=()=>new n(451,"Unavailable For Headless Browser"),u=(e,t)=>{if((e=>{var t;return!(null==(t=e.list)?void 0:t.length)||!e.watchVariable})(e))return!1;((e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if("string"!=typeof t)throw"The BlockList watchVariable has to be a string"})(e.list,e.watchVariable);const r=(i=t,o=e.watchVariable,i instanceof FormData?i.get(o):i[o]);var i,o;return"string"==typeof r&&e.list.includes(r)},b=()=>new n(403,"Forbidden"),f=(e,t,r)=>s(void 0,null,function*(){if(!t.throttle||!r)return!1;((e,t)=>{if("number"!=typeof e||0>e)throw"The LimitRate throttle has to be a positive number";if(t&&"string"!=typeof t)throw"The LimitRate ID has to be a non-empty string"})(t.throttle,t.id);const i=t.id||e,o=yield((e,t,r)=>s(void 0,null,function*(){const i=+((yield r.get(e))||0);return t-Date.now()+i}))(i,t.throttle,r);return o>0||(yield r.set(i,Date.now().toString()),!1)}),g=()=>new n(429,"Too Many Requests"),y={init:(e,t="https://api.emailjs.com")=>{if(!e)return;const r=c(e);l.publicKey=r.publicKey,l.blockHeadless=r.blockHeadless,l.storageProvider=r.storageProvider,l.blockList=r.blockList,l.limitRate=r.limitRate,l.origin=r.origin||t},send:(e,t,r,i)=>s(void 0,null,function*(){const o=c(i),s=o.publicKey||l.publicKey,n=o.blockHeadless||l.blockHeadless,y=o.storageProvider||l.storageProvider,v=a(a({},l.blockList),o.blockList),w=a(a({},l.limitRate),o.limitRate);return n&&p(navigator)?Promise.reject(h()):(m(s,e,t),(e=>{if(e&&"[object Object]"!==e.toString())throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"})(r),r&&u(v,r)?Promise.reject(b()):(yield f(location.pathname,w,y))?Promise.reject(g()):d("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:e,template_id:t,template_params:r}),{"Content-type":"application/json"}))}),sendForm:(e,t,r,i)=>s(void 0,null,function*(){const o=c(i),s=o.publicKey||l.publicKey,n=o.blockHeadless||l.blockHeadless,y=l.storageProvider||o.storageProvider,v=a(a({},l.blockList),o.blockList),w=a(a({},l.limitRate),o.limitRate);if(n&&p(navigator))return Promise.reject(h());const P=(e=>"string"==typeof e?document.querySelector(e):e)(r);m(s,e,t),(e=>{if(!e||"FORM"!==e.nodeName)throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"})(P);const j=new FormData(P);return u(v,j)?Promise.reject(b()):(yield f(location.pathname,w,y))?Promise.reject(g()):(j.append("lib_version","4.4.1"),j.append("service_id",e),j.append("template_id",t),j.append("user_id",s),d("/api/v1.0/email/send-form",j))}),EmailJSResponseStatus:n};export{y as e};
