import{r as s,j as e,L as a}from"./react-D2emROiK.js";import{d as t,s as l,u as i}from"./components-C8up8p0n.js";import{q as c,d as n,w as r,e as d,f as o,h as m,j as h,k as x,u,l as b,r as j,m as g,n as f}from"./firebase-DnDUR7D_.js";var N=Object.defineProperty,p=Object.getOwnPropertySymbols,v={}.hasOwnProperty,y={}.propertyIsEnumerable,w=(s,e,a)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,D=(s,e)=>{for(var a in e||(e={}))v.call(e,a)&&w(s,a,e[a]);if(p)for(var a of p(e))y.call(e,a)&&w(s,a,e[a]);return s},k=(s,e,a)=>new Promise((t,l)=>{var i=s=>{try{n(a.next(s))}catch(e){l(e)}},c=s=>{try{n(a.throw(s))}catch(e){l(e)}},n=s=>s.done?t(s.value):Promise.resolve(s.value).then(i,c);n((a=a.apply(s,e)).next())});const P="blogs",C=s=>s.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),L=(s,e)=>k(void 0,null,function*(){const a=j(l,`blog-images/${e}-${Date.now()}`),t=yield g(a,s);return yield f(t.ref)}),S=()=>k(void 0,null,function*(){try{const s=c(n(t,P),r("status","==","published"),d("publishDate","desc"));return(yield o(s)).docs.map(s=>{const e=s.data();return D({id:s.id},e)})}catch(s){const e=c(n(t,P),r("status","==","published"));return(yield o(e)).docs.map(s=>{const e=s.data();return D({id:s.id},e)}).sort((s,e)=>new Date(e.publishDate).getTime()-new Date(s.publishDate).getTime())}}),A=s=>k(void 0,null,function*(){const e=c(n(t,P),r("slug","==",s)),a=yield o(e);if(a.empty)return null;const l=a.docs[0];return D({id:l.id},l.data())}),E=s=>k(void 0,null,function*(){const e=m(t,P,s),a=yield h(e);return a.exists()?D({id:a.id},a.data()):null}),O=s=>k(void 0,null,function*(){const e=C(s.title);let a="";s.image&&(a=yield L(s.image,e));const l={slug:e,title:s.title,author:s.author,publishDate:s.publishDate,status:s.status,imageUrl:a,content:s.content,excerpt:s.content.replace(/<[^>]*>/g,"").substring(0,150)+"..."};return(yield x(n(t,P),l)).id}),T=(s,e)=>k(void 0,null,function*(){const a=m(t,P,s),l=C(e.title);let i={slug:l,title:e.title,author:e.author,publishDate:e.publishDate,status:e.status,content:e.content,excerpt:e.content.replace(/<[^>]*>/g,"").substring(0,150)+"..."};e.image&&(i.imageUrl=yield L(e.image,l)),yield u(a,i)});var U=(s,e,a)=>new Promise((t,l)=>{var i=s=>{try{n(a.next(s))}catch(e){l(e)}},c=s=>{try{n(a.throw(s))}catch(e){l(e)}},n=s=>s.done?t(s.value):Promise.resolve(s.value).then(i,c);n((a=a.apply(s,e)).next())});const $=()=>{const[l,r]=s.useState([]),[h,x]=s.useState(!0),{logout:u}=i();s.useEffect(()=>{j()},[]);const j=()=>U(void 0,null,function*(){try{const s=yield k(void 0,null,function*(){const s=c(n(t,P),d("publishDate","desc"));return(yield o(s)).docs.map(s=>D({id:s.id},s.data()))});r(s)}catch(s){}finally{x(!1)}});if(h)return e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"100vh"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner-border text-primary mb-3",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"text-muted",children:"Loading dashboard..."})]})});const g=l.filter(s=>"published"===s.status).length,f=l.filter(s=>"draft"===s.status).length;return e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f8f9fa",paddingTop:"80px"},children:[e.jsx("section",{className:"py-5",style:{backgroundColor:"#336021"},children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"text-white",children:[e.jsx("h1",{className:"display-4 fw-bold mb-2",children:"Blog Dashboard"}),e.jsx("p",{className:"lead mb-0",children:"Manage your blog posts and content with ease"})]})}),e.jsx("div",{className:"col-lg-4 text-lg-end",children:e.jsxs("div",{className:"d-flex gap-2 justify-content-lg-end justify-content-start mt-3 mt-lg-0",children:[e.jsxs(a,{to:"/admin/blog/new",className:"btn btn-light btn-lg",children:[e.jsx("i",{className:"fas fa-plus me-2"}),"New Post"]}),e.jsxs(a,{to:"/admin/quotes",className:"btn btn-outline-light btn-lg",children:[e.jsx("i",{className:"fas fa-calculator me-2"}),"Quotes"]}),e.jsxs("button",{onClick:()=>U(void 0,null,function*(){try{yield u()}catch(s){}}),className:"btn btn-outline-light btn-lg",children:[e.jsx("i",{className:"fas fa-sign-out-alt me-2"}),"Logout"]})]})})]})})}),e.jsxs("div",{className:"container py-5",children:[e.jsxs("div",{className:"row g-4 mb-5",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-primary bg-opacity-10 rounded-3 p-3",children:e.jsx("i",{className:"fas fa-file-alt text-primary fs-4"})})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h6",{className:"text-muted mb-1",children:"Total Posts"}),e.jsx("h3",{className:"mb-0 fw-bold",children:l.length})]})]})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-success bg-opacity-10 rounded-3 p-3",children:e.jsx("i",{className:"fas fa-check-circle text-success fs-4"})})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h6",{className:"text-muted mb-1",children:"Published"}),e.jsx("h3",{className:"mb-0 fw-bold text-success",children:g})]})]})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-warning bg-opacity-10 rounded-3 p-3",children:e.jsx("i",{className:"fas fa-clock text-warning fs-4"})})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h6",{className:"text-muted mb-1",children:"Drafts"}),e.jsx("h3",{className:"mb-0 fw-bold text-warning",children:f})]})]})})})})]}),e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header bg-white border-bottom",children:e.jsx("h5",{className:"mb-0 fw-bold",children:"All Blog Posts"})}),e.jsx("div",{className:"card-body p-0",children:0===l.length?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"mb-4",children:e.jsx("i",{className:"fas fa-file-alt text-muted",style:{fontSize:"4rem"}})}),e.jsx("h4",{className:"text-muted mb-3",children:"No blog posts yet"}),e.jsx("p",{className:"text-muted mb-4",children:"Get started by creating your first blog post"}),e.jsxs(a,{to:"/admin/blog/new",className:"btn btn-success btn-lg",children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Create Your First Post"]})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"border-0",children:"Post"}),e.jsx("th",{scope:"col",className:"border-0",children:"Author"}),e.jsx("th",{scope:"col",className:"border-0",children:"Date"}),e.jsx("th",{scope:"col",className:"border-0",children:"Status"}),e.jsx("th",{scope:"col",className:"border-0 text-end",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.title,className:"rounded me-3",style:{width:"60px",height:"60px",objectFit:"cover"}}):e.jsx("div",{className:"bg-light rounded me-3 d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"fas fa-image text-muted"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1 fw-semibold",children:s.title}),e.jsxs("small",{className:"text-muted",children:[s.content.replace(/<[^>]*>/g,"").substring(0,80),"..."]})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-user-circle text-muted me-2"}),s.author]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-calendar text-muted me-2"}),new Date(s.publishDate).toLocaleDateString()]})}),e.jsx("td",{className:"py-3",children:e.jsxs("span",{className:"badge "+("published"===s.status?"bg-success":"bg-warning text-dark"),children:[e.jsx("i",{className:`fas ${"published"===s.status?"fa-check-circle":"fa-clock"} me-1`}),s.status]})}),e.jsx("td",{className:"py-3 text-end",children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsxs(a,{to:"/admin/blog/edit/"+s.id,className:"btn btn-outline-primary btn-sm",children:[e.jsx("i",{className:"fas fa-edit me-1"}),"Edit"]}),e.jsxs("button",{onClick:()=>{return e=s.id,U(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this blog post?"))try{yield(s=>k(void 0,null,function*(){const e=m(t,P,s);yield b(e)}))(e),r(l.filter(s=>s.id!==e))}catch(s){alert("Error deleting blog post")}});var e},className:"btn btn-outline-danger btn-sm",children:[e.jsx("i",{className:"fas fa-trash me-1"}),"Delete"]})]})})]},s.id))})]})})})]})]})]})};export{$ as A,A as a,S as b,O as c,E as g,T as u};
