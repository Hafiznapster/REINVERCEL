import{q as t,d as e,w as a,e as s,f as n,h as i,j as l,k as r,u as o,l as u,r as c,m as d,n as p}from"./firebase-TjvCnjKK.js";import{d as m,s as g}from"./components-D9p8cGcG.js";var b=Object.defineProperty,y=Object.getOwnPropertySymbols,h={}.hasOwnProperty,f={}.propertyIsEnumerable,v=(t,e,a)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,D=(t,e)=>{for(var a in e||(e={}))h.call(e,a)&&v(t,a,e[a]);if(y)for(var a of y(e))f.call(e,a)&&v(t,a,e[a]);return t},w=(t,e,a)=>new Promise((s,n)=>{var i=t=>{try{r(a.next(t))}catch(e){n(e)}},l=t=>{try{r(a.throw(t))}catch(e){n(e)}},r=t=>t.done?s(t.value):Promise.resolve(t.value).then(i,l);r((a=a.apply(t,e)).next())});const x="blogs",j=t=>t.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),P=(t,e)=>w(void 0,null,function*(){const a=c(g,`blog-images/${e}-${Date.now()}`),s=yield d(a,t);return yield p(s.ref)}),O=()=>w(void 0,null,function*(){try{const i=t(e(m,x),a("status","==","published"),s("publishDate","desc"));return(yield n(i)).docs.map(t=>{const e=t.data();return D({id:t.id},e)})}catch(i){const s=t(e(m,x),a("status","==","published"));return(yield n(s)).docs.map(t=>{const e=t.data();return D({id:t.id},e)}).sort((t,e)=>new Date(e.publishDate).getTime()-new Date(t.publishDate).getTime())}}),T=()=>w(void 0,null,function*(){const a=t(e(m,x),s("publishDate","desc"));return(yield n(a)).docs.map(t=>D({id:t.id},t.data()))}),U=s=>w(void 0,null,function*(){const i=t(e(m,x),a("slug","==",s)),l=yield n(i);if(l.empty)return null;const r=l.docs[0];return D({id:r.id},r.data())}),$=t=>w(void 0,null,function*(){const e=i(m,x,t),a=yield l(e);return a.exists()?D({id:a.id},a.data()):null}),k=t=>w(void 0,null,function*(){const a=j(t.title);let s="";t.image&&(s=yield P(t.image,a));const n={slug:a,title:t.title,author:t.author,publishDate:t.publishDate,status:t.status,imageUrl:s,content:t.content,excerpt:t.content.replace(/<[^>]*>/g,"").substring(0,150)+"..."};return(yield r(e(m,x),n)).id}),q=(t,e)=>w(void 0,null,function*(){const a=i(m,x,t),s=j(e.title);let n={slug:s,title:e.title,author:e.author,publishDate:e.publishDate,status:e.status,content:e.content,excerpt:e.content.replace(/<[^>]*>/g,"").substring(0,150)+"..."};e.image&&(n.imageUrl=yield P(e.image,s)),yield o(a,n)}),z=t=>w(void 0,null,function*(){const e=i(m,x,t);yield u(e)});export{$ as a,U as b,k as c,z as d,O as e,T as g,q as u};
